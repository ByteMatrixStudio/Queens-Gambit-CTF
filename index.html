<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Queens Gambit CTF</title><link rel="stylesheet" href="./assets/vendor/chessboardjs-1.0.0/css/chessboard-1.0.0.min.css"><style>body{margin:0;min-height:100vh;background:#0b0f14;color:#e6edf3;font-family:Arial,sans-serif;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:18px}h1{margin:0;font-size:48px;letter-spacing:1px}#board{width:780px;max-width:92vw}.wrap{padding:28px;border-radius:16px;background:rgba(255,255,255,.04);box-shadow:0 10px 30px rgba(0,0,0,.45);width:fit-content}#status{margin-top:14px;font-size:18px;opacity:.95;max-width:780px;line-height:1.35}#successScreen{display:none;padding:28px;border-radius:16px;background:rgba(255,255,255,.04);box-shadow:0 10px 30px rgba(0,0,0,.45);width:min(1000px,92vw);text-align:center;opacity:0;transform:translateY(8px);transition:opacity 250ms ease,transform 250ms ease}#successScreen.show{opacity:1;transform:translateY(0)}#successScreen h2{margin:0 0 10px 0;font-size:42px;letter-spacing:1px}#successScreen p{margin:0 0 18px 0;opacity:.9;font-size:18px}#restartBtn{margin-top:18px;padding:10px 14px;border-radius:10px;border:1px solid rgba(255,255,255,.18);background:rgba(255,255,255,.06);color:#e6edf3;cursor:pointer;font-size:16px}#restartBtn:hover{background:rgba(255,255,255,.10)}</style></head><body><div class="wrap" id="gameScreen"><h1>Chess Board</h1><div id="board"></div><div id="status"></div></div><div id="successScreen"><h2>Well played.</h2><p>You found the idea hiding in plain sight.</p><p id="p"></p><div><button id="restartBtn" type="button">Restart</button></div></div><script src="https://code.jquery.com/jquery-3.7.1.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script><script src="./assets/vendor/chessboardjs-1.0.0/js/chessboard-1.0.0.min.js"></script><script>const A=[[[128,171,15,234],[159,81,76,49]],[[172,200,44,73],[181,50,105,145]],[[117,83,105,208],[111,165,4,134]],[[177,220,72,56],[158,187,191,35]],[[175,39,220,204],[10,102,55,97]],[[94,156,188,185],[111,171,190,219]],[[77,178,222,171],[53,95,67,242]],[[191,216,30,190],[126,84,70,52]],[[16,17,127,14],[206,207,128,25]],[[36,105,151,106],[60,149,211,179]]],B=[209,46,57,92,51,108,52,202,214,194,85,145,191,119,32,16,35,238,24,234,244,198,192,53,36,37,47,215,67,166,137,240,52,158,183,14,235,211,190,123],HINTS=["The center is the heart of the board. Start there.","A familiar pawn offer can steer the game into classic territory…","Develop a knight. Nothing fancy yet.","Bring another piece out. Keep it principled.","Open a lane without overcommitting.","A quiet bishop move. Keep options.","King safety matters. Don’t be greedy.","A queen reposition — not an attack yet.","A central queen step. Calm, not flashy.","One more queen step. A clean landing."],WRONG_HINTS=["That doesn’t fit the theme. Think classical.","Close, but the idea is more principled.","Not quite. Try something more central.","The plan is simpler than it looks."],gameScreen=document.getElementById("gameScreen"),successScreen=document.getElementById("successScreen"),restartBtn=document.getElementById("restartBtn"),statusEl=document.getElementById("status"),pp=document.getElementById("p");const J=u=>{u|=0,u^=u<<13,u^=u>>>17,u^=u<<5,u>>>0};const K=(i,w)=>(0x00C0FFEE^(((i+1)*0x9E3779B9)>>>0)^(w?0xA5A5A5A5:0x5A5A5A5A))>>>0;const L=(a,seed)=>{let u=seed>>>0,o="";for(let i=0;i<a.length;i++)u=J(u),o+=String.fromCharCode((a[i]^(u&255))&255);return o};const LINE=A.map((p,i)=>({get w(){return L(p[0],K(i,1))},get b(){return L(p[1],K(i,0))}}));const QUEEN_TARGET_SQUARE=L([222,67],0x0BADF00D);function setStatus(msg){statusEl.textContent=msg}function showSuccessScreen(){pp.textContent=L(B,0xDEADBEEF);gameScreen.style.display="none";successScreen.style.display="block";requestAnimationFrame(()=>successScreen.classList.add("show"))}function resetScreens(){successScreen.classList.remove("show");successScreen.style.display="none";gameScreen.style.display="block"}function uciToMoveObj(uci){return{from:uci.slice(0,2),to:uci.slice(2,4),promotion:"q"}}function isWhiteQueenOn(square){const sq=game.get(square);return!!sq&&sq.color==="w"&&sq.type==="q"}function wrongHint(i){return WRONG_HINTS[i%WRONG_HINTS.length]}var game,board,step=0;function syncBoard(){board.position(game.fen())}function updateHint(){setStatus("White to move. "+(HINTS[step]||"Continue the idea…"))}function newGame(){game=new Chess;step=0;resetScreens();if(board)board.position("start");else board=Chessboard("board",{draggable:!0,position:"start",pieceTheme:"./assets/vendor/chessboardjs-1.0.0/img/chesspieces/wikipedia/{piece}.png",onDragStart:function(source,piece){if(piece.startsWith("b"))return!1;if(game.turn()!=="w")return!1;if(successScreen.style.display==="block")return!1},onDrop:function(source,target){if(source===target)return"snapback";const expected=LINE[step]?.w;if(!expected){setStatus("The board is quiet.");return"snapback"}const uci=source+target;if(uci!==expected){setStatus(wrongHint(step));return"snapback"}const wMove=game.move(uciToMoveObj(uci));if(wMove===null){setStatus("That move isn’t legal.");return"snapback"}syncBoard();if(isWhiteQueenOn(QUEEN_TARGET_SQUARE)){showSuccessScreen();return}const bUci=LINE[step].b;const bMove=game.move(uciToMoveObj(bUci));if(bMove===null){setStatus("Black reply failed.");return}step++;syncBoard();if(isWhiteQueenOn(QUEEN_TARGET_SQUARE)){showSuccessScreen();return}updateHint()}});updateHint()}restartBtn.addEventListener("click",newGame);newGame();</script></body></html>
